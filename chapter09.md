# Զրույց IX։ Ֆայլերի մասին

Ֆայլերի մասին զրույցը միանգամից սկսեմ մի շատ պարզ, բայց հետաքրքիր օրինակով։ Ենթադրենք ունեմ մի տեքստային ֆայլ և ուզում եմ հաշվել, թե անգլերեն այբուբենի տառերն ինչ հաճախությամբ են օգտագործված այդ ֆայլում։ Քայլերիս հաջորդականությունը լինելու է մոտավորապես հետևյալը․ ա) ֆայլը բացել կարդալու համար, բ) նիշ առ նիշ կարդալ նրա պարունակությունը, գ) եթե կարդացած նիշը տառ է, մեկով ավելացնել նրա հաշվիչը, դ) ֆայլի վերջին հասնելուն պես արտածել արդյունքները։

Ֆայլը բացելու համար օգտագործվում է C լեզվի ստանդարտ գրադարանի `fopen` ֆունկցիան, որը ստանում է ֆայլի ճանապարհը և վերադարձնում է `FILE*` տիպի ցուցիչ՝ _ֆայլային հոսքի դեսկրիպտոր_։ Ֆայլը բացող ֆունկցիանի երկրորդ արգումենտով որոշվում է, թե աշխատանքային ինչ ռեժիմում է բացվում ֆայլը՝ գրելու, կարդալու կամ այլ։ Օրինակ, եթե ուզում եմ `test0.txt` ֆայլը բացել կարդալու համար, ապա պետք է գրեմ․

```c
FILE* in = fopen( "test0.txt", "r" );
```

Եթե ֆայլը բացելը ձախողվել է, ապա `fopen` ֆունկցիան վերադարձնում է `NULL` արժեքը։

Ֆայլից մեկ նիշ է կարդում `fgetc` ֆունկցիան, որի արգումենտը ֆայլային հոսքի դեսկրիպտորն է, իսկ վերադարձրած արժեքը կամ կարդացած սիմվոլն է, կամ էլ `EOF` արժեքը՝ երբ հոսքից կարդալ հնարավոր չէ։ Բացի կարդացած արժեքը `EOF`-ի հետ համեմատելուց, ֆայլի ավարտված լինելը կարելի է ստուգել նաև `feof` ֆունկցիայով։ Օրինակ, հետևյալ ցիկլը նիշ առ նիշ կարդում է ֆայլի պարունակությունը և արտածում է ստանդարտ արտածման հոսքին։

```c
while( !feof(inp) )
    putchar( fgetc(inp) );
```


```c
char c = '\0';
while( EOF != (c = fgetc(inp)) )
  if( isalpha(c) )
    ++counters[toupper(c)-'A'];
```

```c
for( char c = '\0'; c != EOF; c = fgetc(inp) )
  if( isalpha(c) )
    ++counters[toupper(c)-'0'];
```

----
Մի որևէ ֆայլի պարունակության հետ աշխատելու (գրելու կամ կարդալու) համար անհրաժեշտ է նախ `fopen` ֆունկցիայով բացել այն։ Այս ֆունցկիայի առաջին պարամետրը ֆայլի ճանապարհն է, իսկ երկրորդը՝ ֆայլը բացելու ռեժիմը։ `fopen` ֆունկցիան վերադարձնում է `FILE*` տիպի ցուցիչ, որը կոչվում է _ֆայլի դեսկրիպտոր_։

Օրինակ, `a0.txt` ֆայլում «Սա տեքստ է։» արտահայտությունն արտածելու համար պետք է գրել հետևյալ ծրագիրը։

```c
void f()
{
  FILE* out = fopen( "a0.txt", "w" ); /* ֆայլը բացել գրելու համար */
  fputs( "Սա տեքստ է։", out ); /* տողն արտածել ֆայլի մեջ */
  fclose( out ); /* փակել ֆայլը */
}
```

`a0.txt` ֆայլի պարունակությունը կարդալու և ստանդարտ արտածման հոսքին դուրս բերելու համար պետք է ֆայլը բացել `"r"` ռեժիմով և նրա պարունակությունը տող առ տող կարդալ `fgets` ֆունկցիայով։ Ֆայլի ավարտը ստուգվում է `feof` ֆունկցիայով։

```c
void g()
{
  FILE* inp = fopen( "a0.txt", "r" ); /* ֆայլը բացել կարդալու համար */
  char buffer[256] = { 0 };
  while( !feof( inp ) ) { /* քանի դեռ ֆայլի վերջը չէ */
    fgets( buffer, 255, inp ); /* ֆայլի հերթական տողը կարդալ buffer- մեջ */
    puts( buffer ); /* արտածել կարդացած տողը */
  }
  fclose( inp ); /* փակել ֆայլը */
}
```




, իսկ աշխատանքն ավարտելուց հետո պետք է `fclose` ֆունցկիայով _փակել_ այն։

_{Ֆայլեր}_
_{Բացել}_
_{Փակել}_
_{Տեքստ, բինար}_
_{Կարդալ}_
_{Գրել}_

CSV ֆայլի ընթերցում։ Տեքստային ֆայլի ընթերցում տողերի տառերի և բառերի քանակի հաշվում (?)։

